name: Deploy to Raspberry Pi

on:
  push:
    branches: [ pi ]

jobs:
  deploy:
    runs-on: self-hosted
    steps:
      # This checks out the code that triggered the workflow
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      
      
      - name: git pull origin pi
        run: |
          pwd
          cd ~/smartablero
          git pull origin pi
      
      # Deploy with Docker Compose
      - name: docker-compose 
        run: |
          docker-compose down
          docker-compose -f docker-compose.yml -f docker-compose.prod.yml up --build -d